<div class="bg-white rounded-lg shadow-lg overflow-hidden">
  <div class="px-6 py-4 bg-gray-50 border-b">
    <h2 class="text-xl font-semibold text-gray-900">
      Search Results ({{ results.length }} {{ searchMode }}{{ results.length !== 1 ? 's' : '' }} found)
    </h2>
  </div>

  <div class="overflow-x-auto">
    <table mat-table [dataSource]="results" class="w-full">
      
      <!-- Train Number / Flight Number Column -->
      <ng-container matColumnDef="trainNumber">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Train No.</th>
        <td mat-cell *matCellDef="let result" class="font-medium text-blue-600">
          {{ isTrainResult(result) ? result.trainNumber : '' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="flightNumber">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Flight No.</th>
        <td mat-cell *matCellDef="let result" class="font-medium text-blue-600">
          {{ isFlightResult(result) ? result.flightNumber : '' }}
        </td>
      </ng-container>

      <!-- Name / Airline Column -->
      <ng-container matColumnDef="trainName">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Train Name</th>
        <td mat-cell *matCellDef="let result" class="text-gray-900">
          {{ isTrainResult(result) ? result.trainName : '' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="airline">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Airline</th>
        <td mat-cell *matCellDef="let result" class="text-gray-900">
          {{ isFlightResult(result) ? result.airline : '' }}
        </td>
      </ng-container>

      <!-- Route Column -->
      <ng-container matColumnDef="route">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Route</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <div class="flex flex-col space-y-1">
            <div class="flex items-center">
              <span class="font-medium">
                {{ isTrainResult(result) ? result.sourceStationCode : (isFlightResult(result) ? result.sourceAirportCode : '') }}
              </span>
              <span class="mx-2 text-gray-400">→</span>
              <span class="font-medium">
                {{ isTrainResult(result) ? result.destinationStationCode : (isFlightResult(result) ? result.destinationAirportCode : '') }}
              </span>
            </div>
            <div class="text-xs text-gray-500">
              {{ isTrainResult(result) ? result.sourceStation + ' → ' + result.destinationStation : 
                 (isFlightResult(result) ? result.sourceCity + ' → ' + result.destinationCity : '') }}
            </div>
          </div>
        </td>
      </ng-container>

      <!-- Timing Column -->
      <ng-container matColumnDef="timing">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Timing</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <div class="flex flex-col space-y-1">
            <div class="flex items-center space-x-2">
              <span class="font-medium">{{ formatTime(result.departureTime) }}</span>
              <span class="text-gray-400">→</span>
              <span class="font-medium">{{ formatTime(result.arrivalTime) }}</span>
            </div>
            <div class="text-xs text-gray-500">
              {{ formatDuration(isTrainResult(result) ? result.journeyTimeMinutes : 
                                (isFlightResult(result) ? result.flightTimeMinutes : 0)) }}
            </div>
            <div class="text-xs text-gray-500">
              {{ formatDate(result.travelDate) }}
            </div>
          </div>
        </td>
      </ng-container>

      <!-- Class Column -->
      <ng-container matColumnDef="class">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Class</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">
            {{ isTrainResult(result) ? result.trainClass : (isFlightResult(result) ? result.flightClass : '') }}
          </span>
        </td>
      </ng-container>

      <!-- Quota Column (Train only) -->
      <ng-container matColumnDef="quota">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Quota</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <span *ngIf="isTrainResult(result)" class="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs">
            {{ result.quotaName }}
          </span>
        </td>
      </ng-container>

      <!-- Availability Column -->
      <ng-container matColumnDef="availability">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Availability</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <div class="flex flex-col space-y-1">
            <span class="px-2 py-1 rounded-full text-xs font-medium" 
                  [ngClass]="getAvailabilityClass(result.availabilityStatus)">
              {{ result.availabilityStatus }}
            </span>
            <div class="text-xs text-gray-600">
              {{ result.availableSeats }}/{{ result.totalSeats }} seats
            </div>
            <div *ngIf="isTrainResult(result) && result.availabilityStatus === 'Waitlist'" 
                 class="text-xs text-red-600">
              WL: {{ result.availableOrWaitlistPosition }}
            </div>
          </div>
        </td>
      </ng-container>

      <!-- Fare Column -->
      <ng-container matColumnDef="fare">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Fare</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <div class="font-semibold text-green-600">
            ₹{{ result.fare | number:'1.2-2' }}
          </div>
          <div class="text-xs text-gray-500">per person</div>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Action</th>
        <td mat-cell *matCellDef="let result" class="text-sm">
          <button 
            mat-raised-button 
            color="primary" 
            (click)="onBook(result)"
            [disabled]="result.availabilityStatus === 'Sold Out'"
            class="text-sm">
            {{ result.availabilityStatus === 'Sold Out' ? 'Sold Out' : 'Book Now' }}
          </button>
        </td>
      </ng-container>

      <!-- Header and Row Definitions -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-gray-50"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
          class="hover:bg-gray-50 border-b border-gray-100"></tr>
    </table>
  </div>

  <!-- No Results Message -->
  <div *ngIf="results.length === 0" class="p-8 text-center text-gray-500">
    <div class="text-lg mb-2">No results found</div>
    <div class="text-sm">Please try different search criteria</div>
  </div>
</div>